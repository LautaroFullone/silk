import{j as e,u as de,d as me,e as xe}from"./data-DYEAm0ln.js";import{r as c}from"./routing-DS5dkcPc.js";import{c as J,n as T,g as ke,a6 as ue,i as De,h as Me,a7 as _e,l as he,a8 as Ae,P as Le,j as P,k as pe,a9 as Ie,aa as Oe,ab as Fe,ac as He,ad as qe,t as E,B as L,s as ze,S as Ue}from"./index-5I7LC1pH.js";import{P as $e,u as Be,a as Qe}from"./Pagination-DHbbnkmq.js";import{e as O}from"./extractErrorDetails-DKJ0Bd4I.js";import{d as Ge,g as Ve,e as Ke,u as Ye,D as Xe,a as We,f as Je,b as Ze,h as es,P as ss,M as ts}from"./requests.service-D10Fb34G.js";import{q as C}from"./reactQueryKeys-DAqxpf92.js";import{r as F,f as rs}from"./formatRelativeTime-DoAEEF_u.js";import{D as as,a as ns,E as os,b as is,c as ls,S as cs,d as ds,C as ms}from"./EmptyBanner-DNcPHaGR.js";import{f as Z}from"./formatDateToShow-BRBfFpow.js";import{C as U,b as $,c as B,a as Q,d as xs}from"./card-Dswx3gmy.js";import{S as h}from"./skeleton-qYKVH_rt.js";import{B as G}from"./badge-WUR6_TQ9.js";import{R as us,S as ne,a as oe,b as ie,c as le,d as k}from"./select-B1p2oqy1.js";import{M as fe}from"./mail-N7RWnUNN.js";import{C as ee}from"./calendar-BCLJcnut.js";import{S as ge}from"./sparkles-D0TPV88W.js";import{C as ce}from"./clock-7EPl51nY.js";import{T as je}from"./trash-2-DXT6qPey.js";import{U as hs}from"./user-DHDTsRiG.js";import{L as z,I as ps}from"./label-TqZvIXcI.js";import{P as fs}from"./PageTitle-Dhp6kvus.js";import"./vendor-CCYiWZgt.js";import"./ActionButton-DAcRzRYb.js";import"./index-B_ymmmjf.js";import"./arrow-left-B0L4L-8W.js";const gs=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]],js=J("circle-dashed",gs);const bs=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],be=J("dollar-sign",bs);const vs=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ns=J("eye",vs);function ys({className:s,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:T("w-full caption-bottom text-sm",s),...t})})}function ws({className:s,...t}){return e.jsx("thead",{"data-slot":"table-header",className:T("[&_tr]:border-b",s),...t})}function Ts({className:s,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:T("[&_tr:last-child]:border-0",s),...t})}function I({className:s,...t}){return e.jsx("tr",{"data-slot":"table-row",className:T("border-gray-200","hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...t})}function S({className:s,...t}){return e.jsx("th",{"data-slot":"table-head",className:T("px-4 py-2","text-foreground h-12 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function w({className:s,...t}){return e.jsx("td",{"data-slot":"table-cell",className:T("p-4 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}var[H]=ke("Tooltip",[ue]),q=ue(),ve="TooltipProvider",Cs=700,V="tooltip.open",[Es,se]=H(ve),Ne=s=>{const{__scopeTooltip:t,delayDuration:r=Cs,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:o}=s,i=c.useRef(!0),m=c.useRef(!1),l=c.useRef(0);return c.useEffect(()=>{const p=l.current;return()=>window.clearTimeout(p)},[]),e.jsx(Es,{scope:t,isOpenDelayedRef:i,delayDuration:r,onOpen:c.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:c.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:m,onPointerInTransitChange:c.useCallback(p=>{m.current=p},[]),disableHoverableContent:a,children:o})};Ne.displayName=ve;var _="Tooltip",[Rs,A]=H(_),ye=s=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a,onOpenChange:o,disableHoverableContent:i,delayDuration:m}=s,l=se(_,s.__scopeTooltip),p=q(t),[d,x]=c.useState(null),g=De(),f=c.useRef(0),j=i??l.disableHoverableContent,N=m??l.delayDuration,u=c.useRef(!1),[b,y]=Me({prop:n,defaultProp:a??!1,onChange:ae=>{ae?(l.onOpen(),document.dispatchEvent(new CustomEvent(V))):l.onClose(),o?.(ae)},caller:_}),v=c.useMemo(()=>b?u.current?"delayed-open":"instant-open":"closed",[b]),R=c.useCallback(()=>{window.clearTimeout(f.current),f.current=0,u.current=!1,y(!0)},[y]),M=c.useCallback(()=>{window.clearTimeout(f.current),f.current=0,y(!1)},[y]),re=c.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{u.current=!0,y(!0),f.current=0},N)},[N,y]);return c.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),e.jsx(_e,{...p,children:e.jsx(Rs,{scope:t,contentId:g,open:b,stateAttribute:v,trigger:d,onTriggerChange:x,onTriggerEnter:c.useCallback(()=>{l.isOpenDelayedRef.current?re():R()},[l.isOpenDelayedRef,re,R]),onTriggerLeave:c.useCallback(()=>{j?M():(window.clearTimeout(f.current),f.current=0)},[M,j]),onOpen:R,onClose:M,disableHoverableContent:j,children:r})})};ye.displayName=_;var K="TooltipTrigger",we=c.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=A(K,r),o=se(K,r),i=q(r),m=c.useRef(null),l=he(t,m,a.onTriggerChange),p=c.useRef(!1),d=c.useRef(!1),x=c.useCallback(()=>p.current=!1,[]);return c.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),e.jsx(Ae,{asChild:!0,...i,children:e.jsx(Le.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:P(s.onPointerMove,g=>{g.pointerType!=="touch"&&!d.current&&!o.isPointerInTransitRef.current&&(a.onTriggerEnter(),d.current=!0)}),onPointerLeave:P(s.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:P(s.onPointerDown,()=>{a.open&&a.onClose(),p.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:P(s.onFocus,()=>{p.current||a.onOpen()}),onBlur:P(s.onBlur,a.onClose),onClick:P(s.onClick,a.onClose)})})});we.displayName=K;var te="TooltipPortal",[Ss,Ps]=H(te,{forceMount:void 0}),Te=s=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=s,o=A(te,t);return e.jsx(Ss,{scope:t,forceMount:r,children:e.jsx(pe,{present:r||o.open,children:e.jsx(Ie,{asChild:!0,container:a,children:n})})})};Te.displayName=te;var D="TooltipContent",Ce=c.forwardRef((s,t)=>{const r=Ps(D,s.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...o}=s,i=A(D,s.__scopeTooltip);return e.jsx(pe,{present:n||i.open,children:i.disableHoverableContent?e.jsx(Ee,{side:a,...o,ref:t}):e.jsx(ks,{side:a,...o,ref:t})})}),ks=c.forwardRef((s,t)=>{const r=A(D,s.__scopeTooltip),n=se(D,s.__scopeTooltip),a=c.useRef(null),o=he(t,a),[i,m]=c.useState(null),{trigger:l,onClose:p}=r,d=a.current,{onPointerInTransitChange:x}=n,g=c.useCallback(()=>{m(null),x(!1)},[x]),f=c.useCallback((j,N)=>{const u=j.currentTarget,b={x:j.clientX,y:j.clientY},y=As(b,u.getBoundingClientRect()),v=Ls(b,y),R=Is(N.getBoundingClientRect()),M=Fs([...v,...R]);m(M),x(!0)},[x]);return c.useEffect(()=>()=>g(),[g]),c.useEffect(()=>{if(l&&d){const j=u=>f(u,d),N=u=>f(u,l);return l.addEventListener("pointerleave",j),d.addEventListener("pointerleave",N),()=>{l.removeEventListener("pointerleave",j),d.removeEventListener("pointerleave",N)}}},[l,d,f,g]),c.useEffect(()=>{if(i){const j=N=>{const u=N.target,b={x:N.clientX,y:N.clientY},y=l?.contains(u)||d?.contains(u),v=!Os(b,i);y?g():v&&(g(),p())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[l,d,i,p,g]),e.jsx(Ee,{...s,ref:o})}),[Ds,Ms]=H(_,{isInside:!1}),_s=qe("TooltipContent"),Ee=c.forwardRef((s,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:o,onPointerDownOutside:i,...m}=s,l=A(D,r),p=q(r),{onClose:d}=l;return c.useEffect(()=>(document.addEventListener(V,d),()=>document.removeEventListener(V,d)),[d]),c.useEffect(()=>{if(l.trigger){const x=g=>{g.target?.contains(l.trigger)&&d()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[l.trigger,d]),e.jsx(Fe,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:x=>x.preventDefault(),onDismiss:d,children:e.jsxs(He,{"data-state":l.stateAttribute,...p,...m,ref:t,style:{...m.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(_s,{children:n}),e.jsx(Ds,{scope:r,isInside:!0,children:e.jsx(us,{id:l.contentId,role:"tooltip",children:a||n})})]})})});Ce.displayName=D;var Re="TooltipArrow",Se=c.forwardRef((s,t)=>{const{__scopeTooltip:r,...n}=s,a=q(r);return Ms(Re,r).isInside?null:e.jsx(Oe,{...a,...n,ref:t})});Se.displayName=Re;function As(s,t){const r=Math.abs(t.top-s.y),n=Math.abs(t.bottom-s.y),a=Math.abs(t.right-s.x),o=Math.abs(t.left-s.x);switch(Math.min(r,n,a,o)){case o:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Ls(s,t,r=5){const n=[];switch(t){case"top":n.push({x:s.x-r,y:s.y+r},{x:s.x+r,y:s.y+r});break;case"bottom":n.push({x:s.x-r,y:s.y-r},{x:s.x+r,y:s.y-r});break;case"left":n.push({x:s.x+r,y:s.y-r},{x:s.x+r,y:s.y+r});break;case"right":n.push({x:s.x-r,y:s.y-r},{x:s.x-r,y:s.y+r});break}return n}function Is(s){const{top:t,right:r,bottom:n,left:a}=s;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function Os(s,t){const{x:r,y:n}=s;let a=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const m=t[o],l=t[i],p=m.x,d=m.y,x=l.x,g=l.y;d>n!=g>n&&r<(x-p)*(n-d)/(g-d)+p&&(a=!a)}return a}function Fs(s){const t=s.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),Hs(t)}function Hs(s){if(s.length<=1)return s.slice();const t=[];for(let n=0;n<s.length;n++){const a=s[n];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=s.length-1;n>=0;n--){const a=s[n];for(;r.length>=2;){const o=r[r.length-1],i=r[r.length-2];if((o.x-i.x)*(a.y-i.y)>=(o.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var qs=Ne,zs=ye,Us=we,$s=Te,Bs=Ce,Qs=Se;function Gs({delayDuration:s=0,...t}){return e.jsx(qs,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function Vs({...s}){return e.jsx(Gs,{children:e.jsx(zs,{"data-slot":"tooltip",...s})})}function Ks({...s}){return e.jsx(Us,{"data-slot":"tooltip-trigger",...s})}function Ys({className:s,sideOffset:t=0,children:r,...n}){return e.jsx($s,{children:e.jsxs(Bs,{"data-slot":"tooltip-content",sideOffset:t,className:T("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...n,children:[r,e.jsx(Qs,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}function Xs(){const s=de(),{mutateAsync:t,isPending:r}=me({mutationFn:Ge,onSuccess:({message:n,request:a})=>{E.success(n),s.setQueryData([C.FETCH_REQUESTS],o=>o&&{...o,requests:o.requests?.filter(i=>i.id!==a.id)||[]})},onError:n=>{if(n?.message==="Network Error")return;const{message:a}=O(n);E.error(a,{id:`error-${C.DELETE_REQUEST}`})}});return{deleteRequestMutate:t,isPending:r}}const Ws=s=>{const{data:t,isLoading:r,error:n,isError:a}=xe({queryKey:[C.FETCH_REQUEST,s.requestId],queryFn:()=>Ve(s.requestId),enabled:!!s.requestId,staleTime:12e5,retry:1});if(a&&n.message!=="Network Error"){const{message:o}=O(n);E.error(o,{id:`error-${C.FETCH_REQUEST}`})}return{request:t?.request||null,isLoading:r,isError:a,error:n}},Js=()=>{const{data:s,isLoading:t,error:r,isError:n}=xe({queryKey:[C.FETCH_REQUESTS],queryFn:Ke,staleTime:12e5,retry:1});if(n&&r.message!=="Network Error"){const{message:a}=O(r);E.error(a,{id:`error-${C.FETCH_REQUESTS}`})}return{requests:s?.requests||[],isLoading:t,isError:n,error:r}},Zs=()=>{const s=de(),{mutateAsync:t,isPending:r}=me({mutationFn:Ye,onSuccess:({message:n,request:a})=>{n==="No hay cambios para aplicar"?E.info(n):(E.success(n),s.setQueryData([C.FETCH_REQUESTS],o=>o&&{...o,requests:o.requests.map(i=>i.id===a.id?a:i)}),s.setQueryData([C.FETCH_REQUEST,a.id],{message:n,request:a}))},onError:n=>{if(n?.message==="Network Error")return;const{message:a}=O(n);E.error(a,{id:`error-${C.UPDATE_REQUEST}`})}});return{updateServiceRequestMutate:t,isPending:r}},Y=({status:s,disableTooltip:t,tooltipSide:r="top",tooltipAlign:n="center"})=>{const{label:a,description:o,color:i,icon:m}=F[s];return t?e.jsxs(G,{className:i,children:[e.jsx(m,{className:"size-4!"}),a]}):e.jsxs(Vs,{children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(G,{className:i,children:[e.jsx(m,{className:"size-4!"}),a]})}),e.jsx(Ys,{side:r,align:n,children:e.jsx("p",{className:"text-sm",children:o})})]})},Pe={PENDING:["CONTACTED","CANCELLED"],CONTACTED:["CONTRACTED","CANCELLED"],CONTRACTED:["CANCELLED"],CANCELLED:[]};function et(s,t){return Pe[s].includes(t)}function st(s){return Pe[s]}function tt(s,t){return et(s,t)?!0:(E.error("Cambio de estado no permitido"),!1)}const X=({request:s,trigger:t,onStatusChange:r})=>{const n=st(s.status),a=n.length>0;return e.jsxs(as,{children:[e.jsx(ns,{asChild:!0,disabled:!a,children:t||e.jsx(os,{className:`h-5 w-5 transition-all duration-200 ${a?"cursor-pointer hover:scale-105":"cursor-not-allowed opacity-50"}`})}),e.jsx(is,{align:"end",children:n.map(o=>{const{label:i,color:m,icon:l}=F[o];return e.jsxs(ls,{onClick:()=>r(o),children:[e.jsx(l,{className:`w-4 h-4 mr-2 ${m} bg-transparent`}),"Marcar como ",i]},o)})})]})},rt=({isOpen:s,requestId:t,onClose:r,onEdit:n})=>{const{request:a,isLoading:o}=Ws({requestId:t});return e.jsx(Xe,{open:s,onOpenChange:i=>i||r(),children:e.jsxs(We,{className:"max-w-5xl max-h-[90vh] overflow-hidden bg-gray-50",children:[e.jsxs(Je,{className:"gap-0",children:[e.jsx(Ze,{className:"font-bold text-2xl",children:"Detalles de la Solicitud"}),e.jsx(es,{asChild:!0,children:e.jsxs("div",{children:["Solicitud ID:"," ",o?e.jsx(h,{className:"inline-block h-3 w-44"}):e.jsx("span",{className:"italic",children:a?.id})]})})]}),e.jsxs("div",{className:"space-y-4 overflow-y-auto max-h-[70dvh]",children:[e.jsx(at,{isLoading:o,request:a,onEdit:n}),e.jsx(nt,{isLoading:o,request:a}),e.jsx(ot,{isLoading:o,request:a})]})]})})},at=({isLoading:s,request:t,onEdit:r})=>s?e.jsxs("div",{className:"bg-white border border-gray-200 rounded-md p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{className:"w-16 h-16 rounded-full"}),e.jsxs("div",{children:[e.jsx(h,{className:"h-8 w-48 mb-2"}),e.jsx(h,{className:"h-4 w-24"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"h-5 w-18 rounded-full"}),e.jsx(h,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:Array.from({length:4}).map((n,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"size-4 rounded"}),e.jsxs("div",{children:[e.jsx(h,{className:"h-4 w-12 mb-1"}),e.jsx(h,{className:"h-5 w-24"})]})]},a))})]}):e.jsxs("div",{className:"bg-emerald-50 border rounded-md p-6 shadow-xs",children:[e.jsxs("div",{className:"flex sm:hidden items-center justify-end gap-3 mb-4",children:[t?.status&&e.jsx(Y,{status:t.status}),t&&e.jsx(X,{request:t,onStatusChange:r})]}),e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"shrink-0 size-16 bg-gradient-to-br from-emerald-500 to-emerald-800 text-white rounded-full flex items-center justify-center font-serif text-3xl shadow-lg uppercase",children:t?.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-serif font-bold text-silk-secondary",children:t?.name}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:rs(t?.createdAt)})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-3 ",children:[t?.status&&e.jsx(Y,{status:t.status}),t&&e.jsx(X,{request:t,onStatusChange:r})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Email"}),e.jsx("p",{className:"text-sm font-semibold text-silk-secondary truncate",children:t?.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Teléfono"}),e.jsx("p",{className:"text-sm font-semibold text-silk-secondary",children:t?.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Ubicación"}),e.jsx("p",{className:"text-sm font-semibold text-silk-secondary",children:t?.ubication})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Fecha"}),e.jsx("p",{className:"text-sm font-semibold text-silk-secondary",children:Z(t?.createdAt,"date")})]})]})]})]}),nt=({isLoading:s,request:t})=>s?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Array.from({length:3}).map((r,n)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx(h,{className:"h-4 w-32 mb-3"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx(h,{className:"h-4 w-24"})]})]},n))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Servicio solicitado"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-emerald-600"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t?.service})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Presupuesto cliente"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-emerald-600"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t?.budget})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Inicio deseado"})}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-emerald-600"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t?.startMoment==="now"?"Inmediatamente":t?.startMoment==="next-month"?"El próximo mes":t?.startMoment==="to-agree"?"A convenir":t?.startMoment})]})]})]}),ot=({isLoading:s,request:t})=>s?e.jsxs(U,{className:"border bg-card",children:[e.jsx($,{className:"pb-4",children:e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-emerald-600"}),"Timeline de la Solicitud"]})}),e.jsx(Q,{children:e.jsx("div",{className:"relative",children:Array.from({length:2}).map((r,n)=>e.jsxs("div",{className:"relative flex items-start gap-3 pb-4",children:[n<1&&e.jsx("div",{className:"absolute left-1 top-6 bottom-0 w-0.5 bg-gray-200 opacity-60"}),e.jsx("div",{className:"relative z-10 mt-1",children:e.jsx(h,{className:"size-2.5 rounded-full border border-white shadow-sm"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"p-3 bg-white rounded-md border border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx(h,{className:"h-4 w-32"}),e.jsx(h,{className:"h-4 w-32"})]}),e.jsx(h,{className:"h-3 w-48"})]})})]},n))})})]}):e.jsxs(U,{className:"border bg-card",children:[e.jsx($,{className:"pb-4",children:e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-emerald-600"}),"Timeline de la Solicitud"]})}),e.jsx(Q,{children:e.jsx("div",{className:"relative",children:t?.timeline&&t.timeline.length>0?t.timeline.map((r,n)=>{const{timelineColor:a}=F[r.type],o=n===t.timeline.length-1;return e.jsxs("div",{className:"relative flex items-start gap-3 pb-3",children:[!o&&e.jsx("div",{className:T("absolute left-1 top-6 bottom-0 w-0.5 opacity-60",{"bg-gradient-to-b from-amber-400 to-gray-200":a==="amber","bg-gradient-to-b from-indigo-400 to-gray-200":a==="indigo","bg-gradient-to-b from-emerald-400 to-gray-200":a==="emerald","bg-gradient-to-b from-stone-400 to-stone-200":a==="stone","bg-gray-200":!a||a==="gray"})}),e.jsx("div",{className:"relative z-10 mt-1",children:e.jsx("div",{className:T("size-2.5 rounded-full border border-white shadow-sm",{"bg-amber-500":a==="amber","bg-indigo-500":a==="indigo","bg-emerald-500":a==="emerald","bg-stone-500":a==="stone","bg-gray-500":!a||a==="gray"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:T("p-3 bg-white rounded-md border transition-all duration-200 hover:shadow-sm",{"border-amber-300 hover:border-amber-400":a==="amber","border-indigo-300 hover:border-indigo-400":a==="indigo","border-emerald-300 hover:border-emerald-400":a==="emerald","border-stone-300 hover:border-stone-400":a==="stone","border-gray-300 hover:border-gray-400":!a||a==="gray"}),children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-medium text-silk-secondary",children:r.title}),e.jsx("span",{className:"text-xs text-gray-400 font-medium whitespace-nowrap",children:Z(r.date,"full")})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:r.description})]})})]},r.id)}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay eventos en el timeline"})})})]}),W=({request:s,onEdit:t,onSelect:r,onDelete:n})=>e.jsxs(I,{children:[e.jsx(w,{className:"text-muted-foreground",children:Z(s.createdAt,"date")}),e.jsxs(w,{className:"font-medium",children:[e.jsx("div",{className:"text-sm",children:s.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.age," ",s.age===1?"año":"años"]})]}),e.jsx(w,{children:s.email}),e.jsx(w,{children:e.jsx(G,{variant:"outline",className:" border-silk-primary-200 bg-silk-primary-100 text-silk-primary-800 rounded-sm",children:s.service})}),e.jsx(w,{className:"font-medium",children:s.budget}),e.jsx(w,{children:e.jsx(Y,{status:s.status})}),e.jsxs(w,{align:"right",className:"space-x-2",children:[e.jsxs(L,{variant:"ghost",size:"sm",onClick:()=>r(s),children:[e.jsx(Ns,{className:"size-4"}),"Ver"]}),e.jsx(X,{request:s,trigger:e.jsxs(L,{variant:"outline",size:"sm",children:[e.jsx(cs,{className:"size-4"}),"Editar"]}),onStatusChange:t}),e.jsxs(L,{size:"sm",variant:"outline",className:"text-destructive!",onClick:()=>n(s),children:[e.jsx(je,{className:"size-4"}),"Eliminar"]})]})]});W.Skeleton=function(){return e.jsxs(I,{children:[e.jsx(w,{children:e.jsx(h,{className:"h-5 w-22"})}),e.jsx(w,{children:e.jsx(h,{className:"h-5 w-20"})}),e.jsx(w,{children:e.jsx(h,{className:"h-6 w-20 mr-4"})}),e.jsx(w,{children:e.jsx(h,{className:"h-5 w-12"})}),e.jsx(w,{children:e.jsx(h,{className:"h-5 w-20"})}),e.jsx(w,{children:e.jsx(h,{className:"h-5 w-20"})}),e.jsx(w,{children:e.jsx(h,{className:"h-5 w-20"})})]})};const it=({paginatedRequests:s,isLoading:t,currentPage:r,totalPages:n,canGoNext:a,canGoPrevious:o,onPageChange:i,emptyMessage:m})=>{const[l,p]=c.useState(null),[d,x]=c.useState(null),{deleteRequestMutate:g,isPending:f}=Xs(),{updateServiceRequestMutate:j}=Zs(),N=async(u,b)=>{const y=s.find(v=>v.id===u);y&&tt(y.status,b)&&await j({requestId:u,status:b})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ys,{className:"min-w-full",children:[e.jsx(ws,{children:e.jsxs(I,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-emerald-800"}),"Fecha"]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4 text-emerald-800"}),"Persona"]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-emerald-800"}),"Email"]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-emerald-800"}),"Servicio"]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-emerald-800"}),"Presupuesto"]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(js,{className:"w-4 h-4 text-emerald-800"}),"Estado"]})}),e.jsx(S,{className:""})]})}),e.jsx(Ts,{children:t?Array.from({length:5}).map((u,b)=>e.jsx(W.Skeleton,{},`skeleton-request-${b}`)):s.length?s.map(u=>e.jsx(W,{request:u,onEdit:async b=>await N(u.id,b),onDelete:x,onSelect:p},u.id)):e.jsx(I,{className:"hover:bg-background ",children:e.jsx(w,{colSpan:7,className:"px-0",children:e.jsx(ds,{title:"No hay solicitudes registradas",description:m})})})})]})}),n>1&&!t&&e.jsx($e,{scrollToTop:!0,currentPage:r,totalPages:n,onPageChange:i,canGoNext:a,canGoPrevious:o}),l&&e.jsx(rt,{isOpen:!!l,requestId:l.id,onEdit:async u=>await N(l.id,u),onClose:()=>p(null)}),e.jsx(ms,{isOpen:!!d,isLoading:f,title:e.jsxs(e.Fragment,{children:["¿Estás seguro que querés eliminar la solicitud de"," ",e.jsx("span",{className:"font-bold",children:d?.name}),"?"]}),description:"Se eliminará permanentemente la solicitud. Esta acción no se puede deshacer.",confirmButton:{icon:je,label:"Eliminar solicitud",loadingLabel:"Eliminando...",variant:"destructive",onConfirm:async()=>{await g(d.id),x(null)}},cancelButton:{label:"No, mantener",variant:"outline",onCancel:()=>x(null)}})]})},At=()=>{const{requests:s,isLoading:t}=Js(),{items:r,searchTerm:n,setSearchTerm:a,filters:o,updateFilter:i,clearFilters:m,hasActiveFilters:l}=Be({data:s,searchFields:["name","email","budget"],initialFilters:{status:"all"}}),{currentPage:p,totalPages:d,startIndex:x,endIndex:g,itemsPerPage:f,goToPage:j,canGoNext:N,canGoPrevious:u,setItemsPerPage:b}=Qe({totalItems:r.length,itemsPerPage:10}),y=r.slice(x,g);return e.jsxs(e.Fragment,{children:[e.jsx(fs,{title:"Gestión de Solicitudes",description:"Visualizá y administrá las respuestas recibidas del formulario de captación."}),e.jsxs(U,{children:[e.jsxs($,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"size-5 text-emerald-800"}),"Listado de Solicitudes"]}),e.jsx(xs,{children:"Filtrá por Nombre, Email, Servicio y/o estado"})]}),e.jsxs(Q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(z,{htmlFor:"search-filter",children:"Buscar por Nombre, Email o Presupuesto"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Ue,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ps,{id:"search-filter",value:n,disabled:!1,className:"pl-8 bg-white",placeholder:"Ej: Germán Beder",onChange:v=>a(v.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"status-filter",children:"Estado"}),e.jsxs(ne,{value:o.status||"all",onValueChange:v=>i("status",v),disabled:t,children:[e.jsx(oe,{className:"mt-1 w-full",id:"status-filter",children:e.jsx(ie,{placeholder:"Todos"})}),e.jsxs(le,{children:[e.jsx(k,{value:"all",children:"Todos"}),Object.entries(F).map(([v,{label:R}])=>e.jsx(k,{value:v,children:R},v))]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between col-span-full gap-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:y.length===0?"Mostrando 0 de 0 solicitudes":`Mostrando ${x+1}-${Math.min(g,r.length)} de ${r.length} solicitudes`}),e.jsxs("div",{className:"flex items-center gap-4 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{htmlFor:"items-per-page",className:"text-sm whitespace-nowrap",children:"Mostrar:"}),e.jsxs(ne,{value:f.toString(),disabled:t,onValueChange:v=>b(v==="*"?"*":Number(v)),children:[e.jsx(oe,{id:"items-per-page",children:e.jsx(ie,{})}),e.jsxs(le,{children:[e.jsx(k,{value:"5",children:"5"}),e.jsx(k,{value:"10",children:"10"}),e.jsx(k,{value:"25",children:"25"}),e.jsx(k,{value:"*",children:"Todos"})]})]})]}),e.jsx(L,{variant:"default",onClick:m,disabled:t||!l,children:"Limpiar Filtros"})]})]})]}),e.jsx(it,{paginatedRequests:y,isLoading:t,currentPage:p,totalPages:d,canGoNext:N,canGoPrevious:u,onPageChange:j,emptyMessage:l?"No hay solicitudes que coincidan con los filtros, probá limpiarlos o intentá con otros términos de búsqueda":"Esperá la primera solicitud a través del formulario de captación"})]})]})]})};export{At as default};
