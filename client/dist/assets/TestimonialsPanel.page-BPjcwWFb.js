import{u as G,d as Q,j as e}from"./data-DYEAm0ln.js";import{r as z,e as y}from"./routing-DS5dkcPc.js";import{t as I,n as V,B as f,r as g,M as U,S as K}from"./index-5I7LC1pH.js";import{P as W,u as J,a as X}from"./Pagination-DHbbnkmq.js";import{u as Y}from"./useFetchTestimonials-CXSwWY-f.js";import{S as M,D as Z,a as ee,E as se,b as ae,c as P,d as le,C as ie}from"./EmptyBanner-DNcPHaGR.js";import{d as re,Q as te}from"./testimonials.service-4Su2N4wS.js";import{e as ne}from"./extractErrorDetails-DKJ0Bd4I.js";import{q as k}from"./reactQueryKeys-DAqxpf92.js";import{g as oe}from"./getPublicImage-Cs9qxQh-.js";import{B as A}from"./badge-WUR6_TQ9.js";import{C as E,a as S,b as de,c as ce,d as me}from"./card-Dswx3gmy.js";import{S as r}from"./skeleton-qYKVH_rt.js";import{S as xe}from"./star-DKjlMvRY.js";import{U as he}from"./user-DHDTsRiG.js";import{T as b}from"./trash-2-DXT6qPey.js";import{A as D}from"./ActionButton-DAcRzRYb.js";import{L as w,I as ue}from"./label-TqZvIXcI.js";import{S as F,a as L,b as q,c as B,d as n}from"./select-B1p2oqy1.js";import{P as je}from"./PageTitle-Dhp6kvus.js";import{P as _}from"./plus-CRQGuSd7.js";import"./vendor-CCYiWZgt.js";import"./index-B_ymmmjf.js";import"./arrow-left-B0L4L-8W.js";function fe(){const s=G(),{mutateAsync:t,isPending:l}=Q({mutationFn:re,onSuccess:({message:a})=>{I.success(a),s.invalidateQueries({queryKey:[k.FETCH_TESTIMONIALS]})},onError:a=>{if(a?.message==="Network Error")return;const{message:i}=ne(a);I.error(i,{id:`error-${k.DELETE_TESTIMONIAL}`})}});return{deleteTestimonialMutate:t,isPending:l}}const T=({testimonial:s,onEdit:t,onDelete:l})=>{const[a,i]=z.useState(!1),m=y();return e.jsx(E,{className:V("overflow-hidden hover:shadow-md relative",s.isActive?"border-l-6 border-l-emerald-700":"border-l-6 border-l-gray-600"),children:e.jsxs(S,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4 min-w-0 z-800",children:[e.jsx("div",{className:"absolute top-2 left-2",children:s.isActive?e.jsx(A,{variant:"default",className:"bg-gradient-to-b from-emerald-600 to-emerald-800 text-white border-none",children:"Publicado"}):e.jsx(A,{variant:"default",className:"bg-gradient-to-b from-gray-500 to-gray-700 text-white border-none",children:"Borrador"})}),e.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-3 border-white shadow-xl",children:e.jsx("img",{alt:s.personRole,className:"w-16 h-16 object-cover",src:oe(s.avatarImagePath),onError:x=>{x.currentTarget.src="/image-placeholder.svg"}})}),s.isHighlight&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-bl from-emerald-600 to-emerald-800 rounded-full p-1 shadow-lg",children:e.jsx(xe,{className:"w-3 h-3 text-white fill-current"})})]}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("h3",{className:"text-xl font-serif text-silk-secondary truncate min-w-0",title:s.personName,children:s.personName}),e.jsxs("div",{className:"flex items-center text-gray-600 text-sm min-w-0",children:[e.jsx(he,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"truncate",children:s.personRole})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center ml-2",children:[e.jsxs("div",{className:"flex-shrink-0 gap-2 hidden md:flex lg:hidden xl:flex",children:[e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>t(s),children:[e.jsx(M,{className:"size-4"}),"Editar"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>l(s),className:"text-destructive!",children:[e.jsx(b,{className:"size-4"}),"Eliminar"]})]}),e.jsx("div",{className:"flex-shrink-0 flex md:hidden lg:flex xl:hidden",children:e.jsxs(Z,{open:a,onOpenChange:i,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(f,{size:"icon",variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx(se,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"Abrir menú"})]})}),e.jsxs(ae,{align:"end",children:[e.jsxs(P,{onClick:()=>{m(g.ADMIN_TESTIMONIAL_EDIT.replace(":testimonialId",s.id)),i(!1)},className:"text-silk-secondary font-normal",children:[e.jsx(M,{className:"mr-3 h-4 w-4 text-silk-secondary"}),"Editar"]}),e.jsxs(P,{onClick:()=>{l(s),i(!1)},className:"text-destructive! hover:bg-red-50!",children:[e.jsx(b,{className:"mr-3 h-4 w-4 text-destructive"}),"Eliminar"]})]})]})})]})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(te,{className:"absolute -top-1 -left-1 w-6 h-6 text-emerald-800"}),e.jsxs("blockquote",{className:"text-gray-700 leading-relaxed pl-5 text-sm italic font-light",children:['"',s.description,'"']})]})})]})})};T.Skeleton=function(){return e.jsx(E,{children:e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx(r,{className:"w-16 h-16 rounded-full"})}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1 space-y-2",children:[e.jsx(r,{className:"h-6 w-32"}),e.jsx(r,{className:"h-4 w-24"})]})]}),e.jsxs("div",{className:"flex items-center ml-2",children:[e.jsxs("div",{className:"hidden md:flex lg:hidden xl:flex gap-2",children:[e.jsx(r,{className:"h-7 w-20"}),e.jsx(r,{className:"h-7 w-20"})]}),e.jsx("div",{className:"flex md:hidden lg:flex xl:hidden",children:e.jsx(r,{className:"h-8 w-8 rounded"})})]})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("div",{className:"relative flex-1 space-y-2",children:e.jsxs("div",{className:"pl-5 space-y-2",children:[e.jsx(r,{className:"h-4 w-full"}),e.jsx(r,{className:"h-4 w-full"}),e.jsx(r,{className:"h-4 w-3/4"})]})})})]})})};const ge=({paginatedTestimonials:s,isLoading:t,currentPage:l,totalPages:a,canGoNext:i,canGoPrevious:m,onPageChange:x,emptyMessage:p})=>{const N=y(),[o,h]=z.useState(null),{deleteTestimonialMutate:v,isPending:j}=fe();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4",children:t?Array.from({length:5}).map((d,u)=>e.jsx(T.Skeleton,{},`skeleton-testimonial-${u}`)):s.length?s.map(d=>e.jsx(T,{testimonial:d,onEdit:u=>N(g.ADMIN_TESTIMONIAL_EDIT.replace(":testimonialId",u.id)),onDelete:h},`testimonial-card-${d.id}`)):e.jsx("div",{className:"col-span-full",children:e.jsx(le,{title:"No hay testimonios registrados",description:p})})}),a>1&&!t&&e.jsx(W,{scrollToTop:!0,currentPage:l,totalPages:a,onPageChange:x,canGoNext:i,canGoPrevious:m}),e.jsx(ie,{isOpen:!!o,isLoading:j,title:e.jsxs(e.Fragment,{children:["¿Estás seguro que querés eliminar el testimonio de"," ",e.jsx("span",{className:"font-bold",children:o?.personName}),"?"]}),description:"Se eliminará permanentemente el testimonio. Esta acción no se puede deshacer.",confirmButton:{icon:b,label:"Eliminar testimonio",loadingLabel:"Eliminando...",variant:"destructive",onConfirm:async()=>{await v(o.id),h(null)}},cancelButton:{label:"No, mantener",variant:"outline",onCancel:()=>h(null)}})]})},Re=()=>{const s=y(),{testimonials:t,isLoading:l}=Y({onlyActive:!1}),{items:a,searchTerm:i,setSearchTerm:m,filters:x,updateFilter:p,clearFilters:N,hasActiveFilters:o}=J({data:t,searchFields:["personName","personRole"],initialFilters:{isHighlight:"all"}}),{currentPage:h,totalPages:v,startIndex:j,endIndex:d,itemsPerPage:u,goToPage:O,canGoNext:H,canGoPrevious:R,setItemsPerPage:$}=X({totalItems:a.length,itemsPerPage:10}),C=a.slice(j,d);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsx(je,{title:"Gestión de Testimonios",description:"Administrá los testimonios de la web"}),e.jsx(D,{size:"lg",icon:_,variant:"primary",label:"Nuevo Testimonio",className:"hidden md:flex",onClick:()=>s(g.ADMIN_TESTIMONIAL_NEW)})]}),e.jsx(D,{size:"lg",icon:_,variant:"primary",label:"Nuevo Testimonio",onClick:()=>s(g.ADMIN_TESTIMONIAL_NEW),className:"md:hidden w-full"}),e.jsxs(E,{children:[e.jsxs(de,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"size-5 text-emerald-800"}),"Listado de Testimonios"]}),e.jsx(me,{children:"Filtrá por Nombre, Rol y/o estado"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(w,{htmlFor:"search-filter",children:"Buscar por Nombre o Rol"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(K,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ue,{id:"search-filter",value:i,disabled:l,className:"pl-8 bg-white",placeholder:"Ej: Germán Beder",onChange:c=>m(c.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"highlight-filter",children:"Estado"}),e.jsxs(F,{value:x.isHighlight||"all",onValueChange:c=>p("isHighlight",c),disabled:l,children:[e.jsx(L,{className:"mt-1 w-full",id:"highlight-filter",children:e.jsx(q,{placeholder:"Todos"})}),e.jsxs(B,{children:[e.jsx(n,{value:"all",children:"Todos"}),e.jsx(n,{value:"true",children:"Destacado"}),e.jsx(n,{value:"false",children:"No Destacado"})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between col-span-full gap-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:C.length===0?"Mostrando 0 de 0 testimonios":`Mostrando ${j+1}-${Math.min(d,a.length)} de ${a.length} testimonios`}),e.jsxs("div",{className:"flex items-center gap-4 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{htmlFor:"items-per-page",className:"text-sm whitespace-nowrap",children:"Mostrar:"}),e.jsxs(F,{value:u.toString(),disabled:l,onValueChange:c=>$(c==="*"?"*":Number(c)),children:[e.jsx(L,{id:"items-per-page",children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(n,{value:"5",children:"5"}),e.jsx(n,{value:"10",children:"10"}),e.jsx(n,{value:"25",children:"25"}),e.jsx(n,{value:"*",children:"Todos"})]})]})]}),e.jsx(f,{variant:"default",onClick:N,disabled:l||!o,children:"Limpiar Filtros"})]})]})]}),e.jsx(ge,{paginatedTestimonials:C,isLoading:l,currentPage:h,totalPages:v,canGoNext:H,canGoPrevious:R,onPageChange:O,emptyMessage:o?"No hay testimonios que coincidan con los filtros, probá limpiarlos o intentá con otros términos de búsqueda":'Hacé clic en "Nuevo Testimonio" para crear el primero'})]})]})]})};export{Re as default};
